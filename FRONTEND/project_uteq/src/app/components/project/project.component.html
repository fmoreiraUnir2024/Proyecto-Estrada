<div style="">
  <header class="bg-gray-200 text-gray-900 py-4 px-6">
    <div class="flex items-center justify-between">
      <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 mr-2">
          <path d="m8 3 4 8 5-5 5 15H2L8 3z"></path>
        </svg>
        <span class="text-lg font-semibold">{{datosProyecto.nombre}}</span>
      </div>
      <div class="flex gap-2">
      
        <button (click)="guardarContenido()"
          class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3">
          <svg class="mr-2" data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 4.72094V13.5C13.5 14.0523 13.0523 14.5 12.5 14.5H11.5V11C11.5 10.4477 11.0523 10 10.5 10H5.5C4.94772 10 4.5 10.4477 4.5 11V14.5H3.5C2.94772 14.5 2.5 14.0523 2.5 13.5V1.5H5V3.25V4H6.5V3.25V1.5H9.47383L13.5 4.72094ZM6 14.5H10V11.5H6V14.5ZM4.5 16H3.5C2.11929 16 1 14.8807 1 13.5V1.5V0H2.5H9.64922C9.87629 0 10.0966 0.0772807 10.2739 0.219131L14.6247 3.69976C14.8619 3.88953 15 4.17684 15 4.48062V13.5C15 14.8807 13.8807 16 12.5 16H11.5H10H6H4.5Z" fill="currentColor"></path></svg>
           Guardar documento
        </button>
        <button
              class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3">
              <svg class="mr-2" data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75ZM13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z" fill="currentColor"></path></svg>
              Descargar
            </button>
            <button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium 
                            ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2
                             focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none 
                             disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground 
                             h-9 rounded-md px-3">
                             <svg class="mr-2" data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 5.25136V4.2487L0.463236 4.05702L7.71324 1.05702L8 0.938354L8.28676 1.05702L15.5368 4.05702L16 4.2487V5.25136L15.5368 5.44304L8.28676 8.44304L8 8.5617L7.71324 8.44304L0.463236 5.44304L0 5.25136ZM0 8.45825V6.83491L0.536764 7.05702L8 10.1453L15.4632 7.05702L16 6.83491V8.45825L8.28676 11.6499L8 11.7686L7.71324 11.6499L0 8.45825ZM0 11.7083V10.0849L0.536764 10.307L8 13.3953L15.4632 10.307L16 10.0849V11.7083L8.28676 14.8999L8 15.0186L7.71324 14.8999L0 11.7083ZM8 6.93835L2.71154 4.75003L8 2.5617L13.2885 4.75003L8 6.93835Z" fill="currentColor"></path></svg>
                             Analisis profundo
            </button>
            <button (click)=" ejecutadorIA()"
            class="text-sm inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3">
            <svg class="mr-2" data-testid="geist-icon" height="16" width="16" stroke-linejoin="round"
              viewBox="0 0 16 16" style="color: currentcolor;">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M8.00002 1.25C5.33749 1.25 3.02334 2.73677 1.84047 4.92183L1.48342 5.58138L2.80253 6.29548L3.15958 5.63592C4.09084 3.91566 5.90986 2.75 8.00002 2.75C10.4897 2.75 12.5941 4.40488 13.2713 6.67462H11.8243H11.0743V8.17462H11.8243H15.2489C15.6631 8.17462 15.9989 7.83883 15.9989 7.42462V4V3.25H14.4989V4V5.64468C13.4653 3.06882 10.9456 1.25 8.00002 1.25ZM1.50122 10.8555V12.5V13.25H0.0012207V12.5V9.07538C0.0012207 8.66117 0.337007 8.32538 0.751221 8.32538H4.17584H4.92584V9.82538H4.17584H2.72876C3.40596 12.0951 5.51032 13.75 8.00002 13.75C10.0799 13.75 11.8912 12.5958 12.8266 10.8895L13.1871 10.2318L14.5025 10.9529L14.142 11.6105C12.9539 13.7779 10.6494 15.25 8.00002 15.25C5.05453 15.25 2.53485 13.4313 1.50122 10.8555Z"
                fill="currentColor"></path>
            </svg>
            Analizar rápido </button>
      </div>

    </div>
  </header>

  <div class="grid grid-cols-1 md:grid-cols-[1fr_300px] gap-5 p-3 md:p-6">
    <div class="bg-white rounded-lg  p- dark:bg-gray-950">
      <editor apiKey="8phbkaeghasw787tkiaq6kczl3xuxk3uwy6u5nffz5hu3enb" [(ngModel)]="editorContent" [init]="{
            setup: setupEditor,
            height: 700,
            menubar: false,
            plugins: [
                'advlist autolink lists link image charmap print preview anchor',
                'searchreplace visualblocks code fullscreen',
                'insertdatetime media table paste code help wordcount'
            ],
            toolbar:
            'undo redo | formatselect | bold italic backcolor | \
            alignleft aligncenter alignright alignjustify | \
            bullist numlist outdent indent | removeformat | help'
        }"></editor>


    </div>
    <div class="bg-white rounded-lg  p- dark:bg-gray-950" 
    style="height: auto; max-height: 100vh; overflow-y: auto;" >
      <div class="space-y-4">
        <div>
          <h3 class="text-lg flex justify-between font-semibold mb-2">
            Referencias
            
          </h3>

          <div class="container" style="height: auto; max-height: 200px; overflow-y: auto;  ">
            <div *ngFor="let refe of referencias" class="grid gap-2">
              <div class="flex items-center text-sm gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="w-5 h-5 text-primary">
                  <path
                    d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5">
                  </path>
                  <path d="M9 18h6"></path>
                  <path d="M10 22h4"></path>
                </svg>
                <div>
                  <h4 class="font-medium">{{refe.titulo}} || {{refe.anio}} </h4>
                  <p class="text-gray-500 dark:text-gray-400 text-sm">
                    {{refe.palabras_clave}}</p>
                  <a [href]="refe.enlace">ver</a>
                </div>
              </div>


            </div>
          </div>

        </div>
        <div *ngIf="referencias.length==0 && feedback.fortalezas.length==0 && feedback.areasParaMejorar.length==0">
          <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 pt-2 ">
            <svg data-testid="geist-icon" height="16" stroke-linejoin="round" viewBox="0 0 16 16" width="16" style="color: currentcolor;">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM6.25002 7H7.00002H7.75C8.30229 7 8.75 7.44772 8.75 8V11.5V12.25H7.25V11.5V8.5H7.00002H6.25002V7ZM8 6C8.55229 6 9 5.55228 9 5C9 4.44772 8.55229 4 8 4C7.44772 4 7 4.44772 7 5C7 5.55228 7.44772 6 8 6Z" fill="currentColor"></path>
            </svg>
            Para comenzar el análisis con gemini haga clic en el botón analizar para comenzar.
          </div>
        </div>
        
        <div *ngIf="feedback.areasParaMejorar.length != 0">
          <div class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 pt-2 space-y-2">
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-gray-50">Puntos fuertes</h3>
              <div class="container" style="font-size: 15px; height: auto; max-height: 150px; overflow-y: auto;">
                <ul *ngFor="let fortaleza of feedback.fortalezas" class="list-disc pl-6 text-gray-600 dark:text-gray-400">
                  <li><strong>{{fortaleza.Aspecto}}:</strong> {{fortaleza.Descripcion}}</li>
                </ul>
              </div>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-gray-50 mb-2">Áreas de mejora</h3>
              <div class="container" style="font-size: 15px; height: auto; max-height: 150px; overflow-y: auto;">
                <ul *ngFor="let area of feedback.areasParaMejorar" class="list-disc pl-6 text-gray-600 dark:text-gray-400">
                  <li><strong>{{area.Aspecto}}:</strong> {{area.Descripcion}}</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div data-orientation="horizontal" role="none" class="shrink-0 bg-gray-100 h-[1px] w-full"></div>
        <div>
          <h3 class="text-lg font-semibold mb-2">Propiedades del Proyecto</h3>
          <div class="flex justify-between bg-gray-100 dark:bg-gray-800  p-2 text-center">
            <p class="text-gray-500 dark:text-gray-400 text-sm">Plantilla utilizada:</p>
            <h4 class="text-sm font-bold">{{nombreplantilla}}</h4>
          </div>
          <div class="flex justify-between bg-gray-100 dark:bg-gray-800  p-2 text-center">
            <p class="text-gray-500 dark:text-gray-400 text-sm">N° Fuentes de conocimiento</p>
            <h4 class="text-sm font-bold">{{fuente.cantidad}}</h4>
          </div>
          <div class="flex justify-between bg-gray-100 dark:bg-gray-800  p-2 text-center">
            <p class="text-gray-500 dark:text-gray-400 text-sm">Tamaño del documento</p>
            <h4 class="text-sm font-bold">{{datosProyecto.contenido.length}}</h4>

          </div>
          <div class="flex justify-between bg-gray-100 dark:bg-gray-800  p-2 text-center">
            <p class="text-gray-500 dark:text-gray-400 text-sm">Tamaño del conococimiento </p>
            <h4 class="text-smfont-bold">{{fuente.contenido.length}}</h4>

          </div>

        </div>
        <div data-orientation="horizontal" role="none" class="shrink-0 bg-gray-100 h-[1px] w-full"></div>
        <div>
          <h3 class="text-lg font-semibold mb-2">Otras opciones:</h3>
          <div class="flex gap-2 ">
            
          </div>
        </div>

      </div>
    </div>
  </div>
  <div class="grid grid-cols-2  gap-6 p-4 md:p-6 md:pt-0">
    <div class="bg-white  p-0 dark:bg-gray-950">      
      <app-feedback 
      (obtenerfeedback)="obtenerfeedback()" 
      [feedback]="markdownContent" 
      ></app-feedback> 
     
    </div>
    <div class="bg-white  p-0 dark:bg-gray-950">
      <button></button>
      <app-grammar-review
       (obtenerAlternativas)="obtenerAlternativas()" 
       [alternativas]="alternativas" [original]="selectedText" ></app-grammar-review>
    </div>
  </div>



  <!-- <app-feedback></app-feedback> -->
</div>